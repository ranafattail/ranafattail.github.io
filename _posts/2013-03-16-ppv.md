---
title: 虚功率定理
tags:
  - 力学
---

显着无事，还不如好好总结下连续介质力学里面的一些东西。今天说说虚功率定理，这个定理，或者说这个形式（弱形式）是之后进行数值求解，特别是有限元方法求解时一个最基本的式子。它把偏微分方程一般的强形式，即一个联系着各个物理量的偏微分的局部方程，转换成一个对解的光滑性要求不怎么高的一个积分形式，使得我们可以得到很多强形式得不到的解（导数不连续的解，比如）。

这里我们不说一般偏微分方程（我事实上没怎么系统学过偏微分方程，上大+UTC 的工程师教育我之恩那个说更偏向实际运用，并非偏研究），就讨论连续介质力学里面的最重要的平衡方程：Cauchy 定理。即存在一个定义在当前位置上的2阶对称张量，叫做应力张量，满足如下式子。这里我们考虑静平衡问题，所以惯性就忽略了。

$$
\operatorname{div}\sigma+\rho f=0
$$

其中 $$\sigma$$ 就是 Cauchy 应力张量，$$\rho$$ 是当前位置下的密度，而 $$f$$ 就是当前位置下单位质量上收到的体积力。这个公式的证明不是特别复杂，我指思路。首先 Cauchy 假设一个面积元上收到的面积力仅仅是这个面积元的法向 $$n$$ 的函数，即事实上在一点两个有相同法向但曲率不同面积收到相同的面积力。当然这是一个假设，但在我们固体力学一般应用中这个假设还是挺成立的。其次，Cauchy 再假设这个面积力事实上是法向 $$n$$ 的一个*线性*函数，而这个线性函数就是 Cauchy 应力张量。好了，然后根据静力学的合力平衡，就推出了上面的式子；而力矩平衡则推出了这个应力张量是对称的，即 $$\sigma=\sigma^\mathsf{t}$$。

但实际我们通常要求解的是位移 $$u$$ 而不是应力，因为我们把位移当作主未知量。这样一来，由于一般应力是位移梯度（一阶导数）的函数，所以这个平衡方程就变成了一个关于位移的二阶偏微分方程。不管是在理论或者数值求解的时候，这个强形式就不是特别方便，为此我们把这个方程进行*对偶化*，即取一个相对光滑的向量场（可以看作是一个假设的速度场或位移场），记作 $$w$$，然后乘到原平衡方程里面并对当前体积积分，得到如下式子。

$$
\int_{\Omega}\operatorname{div}\sigma.w\,\mathrm{d}V+\int_{\Omega}\rho f.w\,\mathrm{d}V=0
$$

根据格林公式和一些演算，可以将第一项转换成如下式子。

$$
\int_{\Omega}\operatorname{div}\sigma.w\,\mathrm{d}V=-\int_{\Omega}\sigma:D(w)\,\mathrm{d}V+\int_{\partial\Omega}(\sigma n).w\,\mathrm{d}A
$$

其中 $$D(w)=(\nabla w+\nabla w^\mathsf{t})/2$$。特别的，如果 $$w$$ 是速度场的时候，那么 $$D(w)$$ 就是变形率张量，即刻画应变的速度。而 $$\sigma:D(w)$$ 正是固体的内功率体密度！这样，我们就得到

$$
\int_{\Omega}\sigma.D(w)\,\mathrm{d}V=\int_{\Omega}\rho f.w\,\mathrm{d}V+\int_{\partial\Omega}(\sigma n).w\,\mathrm{d}A
$$

这就是虚功率定理，表示固体的内功率等于体积外力和面积外力的功率。要注意上式对于所有相对光滑的向量场 $$w$$ 都成立，所以这个虚功率定理，或者这个弱形式，在假设一些原来方程的光滑性要求后，就等价于原来的强形式。但这个弱形式也允许一些原来方程不允许的解，我们发现这个弱形式只涉及到了位移的一阶导数（通过应力），这样一来数值求解就方便了很多。本篇日志目的达成~

下面要说的就是一个扩展了。有限元方法就建立在这个弱形式上，只不过我们这次将解和测试函数 $$w$$ 取在一个有限维的空间中。很明显之前解属于一个有一定光滑性要求的函数空间，是无穷维的；所以我们就取这个无穷维空间中的一个有限维子空间，并希望这个子空间能一定程度上反映或表达出这个解。通过这样，原方程就变成了一个线性方程组问题，可以用数值线性代数求解。

这就是有限元最一般的 Galerkin 方法。有限元是这个方法的一个特例，即在有限维空间的选取上做文章。我们把空间进行网格划分，然后假设解在每个网格上都是一个相对简单的函数（比如线性函数），即解是一个分片定义的全局函数（比如分片线性函数）。这么做有很多好处，比如说构造出来的矩阵就是稀疏的，因为这个有限维空间的基函数的支撑集都很小，这样到最后求解就会很快了。